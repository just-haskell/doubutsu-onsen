
* 時刻が進んでゆくのをどのように表現および管理するか

- 時間がすぎてゆくとある時刻にイベントが起こる

- ユーザーのアクセスのたびに続きの全て時刻のイベントを実行
- 一定間隔のバッチで一括処理
- この 2つの併用でもよいかもしれない

* ユーザー - 属性

- ユーザーのID    -- primary key
- プレイ中のゲームのID
- メールアドレス (Google アカウント?)
- ユーザー名
- 登録時刻

* ゲーム(ゲームを開始するたびに作られる) - 属性
- ゲームのID  -- primary key
- ゲームのオーナーのユーザーID

* 温泉 (ステージ?) - 属性

- 温泉のID       -- primary key
- 温泉の名前
- リリース時刻

* スロット (動物が温泉に入ったり、カスタマイズ用の木の種や実を植えたりする) - 属性

- 温泉のID                  -- 複合 primary key
- 温泉内でのスロットの番号  -- 複合 primary key
- スロットの座標 x
- スロットの座標 y
- スロットの種類              -- 動物が温泉に入る or カスタマイズ用

* 種や木の実の種類 - 属性

- 名前
- レア度 (通常、レア、激レア)

* 動物の種類(個体) - 属性

- 動物のID         -- primary key
- 動物の名前
- 動物の追加時刻

* 動物のスロット占有相対座標

- 動物のID
- 動物内での座標番号
- 相対座標 x
- 相対座標 y

* 種や木の実の所持状態 - 属性

- ゲームのID
- 種や木の実のID
- 個数

* 種や木の実をもらった理由詳細

** 動物が帰ったときにもらう - 属性

- 動物のID

** その他

* ミッションの種類

- はじめてのお客さん
- 特定の動物がn回、来た (初めては 1回目)
- 特定の種あるいは木の実をn回、植えた (初めては 1回目)
- どうぶつのお悩み

* 各ミッション詳細

** はじめてのお客さん - 属性

属性なし?

** 特定の動物がn回、来た - 属性

- 動物のID
- 回数

** 特定の種あるいは木の実をn回、植えた - 属性

- 種や木の実の種類
- 回数

** どうぶつのお悩み - 属性

- 種または木の実のセットのID
- 種または木の実の種類
- 個数

* ミッション (温泉レベルアップ条件) - 属性

- 温泉のID               -- 複合 primary key
- 温泉のレベル           -- 複合 primary key
- ミッションの種類
- 各ミッション詳細のID


* イベントの種類

- 温泉のはじまり - 最初のミッションの提示
- 動物の行動
- 種や木の実をもらう
- 種や木の実を植える or 種や木の実の成長
- ミッション - 開始可能、開始、達成
- 時間が経つ
- 天気が変わる

* 各イベント詳細

** 温泉のはじまり - 属性

- 温泉 (ステージ?) の ID

** 動物の行動 - 属性

- スロットのID
- 動物のID
- 行動の種類 (来る、帰る、癒しポーズ変更)

** 種や木の実をもらう - 属性

- 種や木の実の種類
- もらった理由

** 種や木の実の成長 - 属性

- スロットのID
- 種や木の実の種類
- 成長のレベル? - 植えたときはレベル1

** ミッション(の状態遷移) - 属性

- 温泉のレベル  -- イベントログの温泉のIDとこのレベル値でミッションが特定される
- 遷移後状態

** 時間が経つ - 属性

- 朝、昼、夕方、夜

イベントにせずとも、時刻で判定してよいかもしれない

** 天気が変わる - 属性

- 天気の状態

* イベントログ - 属性

- イベントログのID    -- primary key
- ゲームのID
- 温泉のID
- イベントの種類
- 各イベント詳細のID
- 時刻

イベントログの primary key は本当にこれで良いか?


* 温泉の状態 - 属性

- ゲームのID      -- 複合 primary key
- 温泉のID          -- 複合 primary key
- 更新時刻
- 温泉のレベル
- 座標リストの生成元 (ランダム性ありのとき。ランダム性無しでも固定値を入れておく?)
- 開始時刻

* スロットの(状態の)種類

- 動物
- カスタマイズ

* スロットの状態詳細
** 動物 - 属性

- ゲームのID        -- 複合 primary key
- 温泉のID          -- 複合 primary key
- スロットのID      -- 複合 primary key
- 動物のID
- 動物のポーズ?

** カスタマイズ - 属性

- ゲームのID        -- 複合 primary key
- 温泉のID          -- 複合 primary key
- スロットのID      -- 複合 primary key
- 種や木の実の種類
- 種あるいは木の実の成長度

  ※ 状態は各フィールドを書き換える。
     状態の詳細を固定にし、ポインタの張り替えで状態変化を表現することになると、
     状態変化のたびに、詳細テーブルのフィールドを条件に検索する必要が出てきてしまう。
     たとえばイベントログは一度書けば内容が固定なので、
     そのような(詳細テーブルのフィールドを条件に検索する)必要がない。
